<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Firebase Auth Test</title>
  </head>
  <body>
    <div id="auth">
      <p id="status">Please log in</p>
      <input id="email" type="email" placeholder="Email" />
      <input id="password" type="password" placeholder="Password" />
      <button onclick="register()">Register</button>
      <button onclick="login()">Login</button>
    </div>

    <div id="content" style="display:none;">
      <p id="user-info"></p>
      <button onclick="logout()">Logout</button>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
      import {
        getAuth,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        onAuthStateChanged,
        signOut
      } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyCN8ypq4TxhLwjseqnDJneBO2j_BlARz0M",
        authDomain: "chat-or-somethig.firebaseapp.com",
        databaseURL: "https://chat-or-somethig-default-rtdb.firebaseio.com",
        projectId: "chat-or-somethig",
        storageBucket: "chat-or-somethig.firebasestorage.app",
        messagingSenderId: "598777875087",
        appId: "1:598777875087:web:d100536dd269bc0a9d7efa",
        measurementId: "G-VQQ0TYRNNH"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      const authBox = document.getElementById("auth");
      const content = document.getElementById("content");
      const status = document.getElementById("status");
      const userInfo = document.getElementById("user-info");
      const email = document.getElementById("email");
      const password = document.getElementById("password");

      window.register = () => {
        createUserWithEmailAndPassword(auth, email.value, password.value)
          .catch(err => alert(err.message));
      };

      window.login = () => {
        signInWithEmailAndPassword(auth, email.value, password.value)
          .catch(err => alert(err.message));
      };

      window.logout = () => signOut(auth);

      onAuthStateChanged(auth, user => {
        if (user) {
          authBox.style.display = "none";
          content.style.display = "block";
          status.textContent = "Logged in";
          userInfo.textContent = "Logged in as " + user.email;
        } else {
          authBox.style.display = "block";
          content.style.display = "none";
          status.textContent = "Please log in";
        }
      });
    </script>
  </body>
</html>
